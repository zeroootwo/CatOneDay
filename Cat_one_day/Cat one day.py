import os
import sys
import time
import textwrap
from pathlib import Path
import json
from platformdirs import user_data_dir

def get_save_path():
    app_name="Cat_One_Day"
    data_dir=Path(user_data_dir(app_name, "Velyka"))

    data_dir.mkdir(parents=True, exist_ok=True)
    return data_dir / "records.json"

def draw_box(lines):
    max_width = 70
    processed_lines = []
    for line in lines:
        if line == "---":
            processed_lines.append("---")
        elif not line:
            processed_lines.append("")
        else:
            processed_lines.extend(textwrap.wrap(line, width=max_width))
    content_lines = [l for l in processed_lines if l != "---"]
    if not content_lines:
        width = max_width
    else:
        width = max([len(line) for line in content_lines])
    print(f"‚ïî{'‚ïê' * (width + 2)}‚ïó")
    for line in processed_lines:
        if line == "---":
            print(f"‚ï†{'‚ïê' * (width + 2)}‚ï£")
        else:
            print(f"‚ïë {line.ljust(width)} ‚ïë")
    print(f"‚ïö{'‚ïê' * (width + 2)}‚ïù")

def save_result(player_name, score, total_time):
    new_result={
        "player_name": player_name,
        "score": score,
        "total_time": total_time
    }
    filename=get_save_path()
    if not filename.exists():
        with filename.open("w", encoding="utf-8") as f:
            json.dump([], f)
    try:
        with filename.open("r", encoding="utf-8") as f:
            all_results=json.load(f)
    except (json.decoder.JSONDecodeError, ValueError):
        all_results=[]
        print("[!] –û—à–∏–±–∫–∞: —Ñ–∞–π–ª —Ä–µ–∫–æ—Ä–¥–æ–≤ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω. –ù–∞—á–∏–Ω–∞–µ–º —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞.")
    all_results.append(new_result)
    with filename.open("w", encoding="utf-8") as f:
        json.dump(all_results, f, indent=4, ensure_ascii=False)
    print("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–ø–∏—Å–∞–Ω—ã –≤ —Ç–∞–±–ª–∏—Ü—É!")
    return

def draw_hud(current_lives, current_score):
    stats=f"–ñ–∏–∑–Ω–∏{"‚ù§ " * current_lives} | –û—á–∫–∏: {current_score}"
    print(stats.rjust(75))

def cat_anim():
    time.sleep(1)
    for i in range(5):
        os.system('cls' if os.name == 'nt' else 'clear')
        print(r"""
          /\_/\
         ( o.o )
          > ^ <
         /     \
        |       |\__
         \_____/  `*)
        """)
        time.sleep(3)
        os.system('cls' if os.name == 'nt' else 'clear')
        print(r"""
          /\_/\
         ( -.- )
          > ^ <
         /     \
        |       |\__
         \_____/  `*)
        """)
        time.sleep(0.2)
    os.system('cls' if os.name == 'nt' else 'clear')

def start_game():
    while True:
        name=input("–î–∞–π –∏–º—è –∫–æ—Ç–∏–∫—É (–î–æ 10 —Å–∏–º–≤–æ–ª–æ–≤!): ").capitalize().strip()
        os.system('cls' if os.name == 'nt' else 'clear')
        if not name:
            print("–ò–º—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º!")
        elif len(name) >10:
            print("–ò–º—è —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ:(\n–ú–∞–∫—Å–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤!")
        elif not name.isalpha():
            print("–ù–∞–¥–æ –±—É–∫–≤—ã –≤–≤–æ–¥–∏—Ç—å, –∞ –Ω–µ —Ü–∏—Ñ—Ä—ã")
        else:
            player_name=name
            break
    lives=3
    score=0
    start_time=time.time()
    #–ì–ª–∞–≤–∞ 1
    try:
        draw_hud(lives, score)
        print(r"""
                   |\      _,,,---,,_
            ZZZzz /,`.-'`'    -.  ;-;;,_
                 |,4-  ) )-,_. ,\ (  `'-'
                '---''(_/--'  `-'\_)
        """)
        draw_box([f"{player_name} –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –æ–¥–∏–Ω –≥–ª–∞–∑. –°–æ–ª–Ω–µ—á–Ω—ã–π –ª—É—á –º–µ–¥–ª–µ–Ω–Ω–æ –ø–æ–ª–∑–µ—Ç –ø–æ –∫–æ–≤—Ä—É, –¥—Ä–∞–∑–Ω—è \n–ø—ã–ª–∏–Ω–∫–∏. –í –∫–≤–∞—Ä—Ç–∏—Ä–µ —Ç–∏—Ö–æ, —Å–ª—ã—à–Ω–æ —Ç–æ–ª—å–∫–æ —Å–æ–ø–µ–Ω–∏–µ –∫–æ–∂–∞–Ω—ã—Ö –º–µ—à–∫–æ–≤ –ø–æ–¥ –æ–¥–µ—è–ª–æ–º. \n{player_name} –ø–æ—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è, —á—É–≤—Å—Ç–≤—É—è –∫–∞–∂–¥—É—é –º—ã—à—Ü—É. –ï–≥–æ –∂–µ–ª—É–¥–æ–∫ —É—Ä—á–∏—Ç —Ç–∞–∫ –≥—Ä–æ–º–∫–æ, —á—Ç–æ —ç—Ç–æ—Ç \n–∑–≤—É–∫ –º–æ–≥ –±—ã —Ä–∞–∑–±—É–¥–∏—Ç—å —Å–æ—Å–µ–¥–µ–π. –ì–æ–ª–æ–¥ ‚Äî –Ω–µ —Ç–µ—Ç–∫–∞, –≥–æ–ª–æ–¥ ‚Äî —ç—Ç–æ {player_name}. –ü–æ—Ä–∞ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å.",
                    "---",
                    "1. –ü—Ä—ã–≥–Ω—É—Ç—å —Ö–æ–∑—è–∏–Ω—É –Ω–∞ –∂–∏–≤–æ—Ç.",
                    "2. –ü–æ–π—Ç–∏ –Ω–∞ –∫—É—Ö–Ω—é –∏ –æ—Ä–∞—Ç—å.",
                    "3. –ü–æ–¥—Ä–∞—Ç—å –¥–∏–≤–∞–Ω."
                    ])
        ans=int(input("–í–∞—à –≤—ã–±–æ—Ä: "))
        os.system('cls' if os.name == 'nt' else 'clear')
        match ans:
            case 1:
                lives-=1
                #input(f"-1 –∂–∏–∑–Ω—å.\n{player_name} –¥–µ–ª–∞–µ—Ç ¬´–±–æ–º–±–æ—á–∫—É¬ª –Ω–∞ —Å–ø—è—â–µ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞. –•–æ–∑—è–∏–Ω —Å –ø–µ—Ä–µ–ø—É–≥—É —Ä–µ—Ñ–ª–µ–∫—Ç–æ—Ä–Ω–æ –æ—Ç–∫–∏–¥—ã–≤–∞–µ—Ç –∫–æ—Ç–∞. \n–ü–æ–ª–µ—Ç –≤ —Å—Ç–µ–Ω—É –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –±–æ–ª—å–Ω–æ.")
                draw_box(["-1 –∂–∏–∑–Ω—å.",
                          "---",
                         f"{player_name} –¥–µ–ª–∞–µ—Ç ¬´–±–æ–º–±–æ—á–∫—É¬ª –Ω–∞ —Å–ø—è—â–µ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞. –•–æ–∑—è–∏–Ω —Å –ø–µ—Ä–µ–ø—É–≥—É —Ä–µ—Ñ–ª–µ–∫—Ç–æ—Ä–Ω–æ –æ—Ç–∫–∏–¥—ã–≤–∞–µ—Ç –∫–æ—Ç–∞. \n–ü–æ–ª–µ—Ç –≤ —Å—Ç–µ–Ω—É –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –±–æ–ª—å–Ω–æ."])
                input()
            case 2:
                score+=20
                draw_box(["+20 –æ—á–∫–æ–≤.",
                          "---",
                          f"{player_name} —Å–ª–∞–≤–Ω–æ –ø–æ—Ç–æ—á–∏–ª –∫–æ–≥—Ç–∏. –î–∏–≤–∞–Ω –∏—Å–ø–æ—Ä—á–µ–Ω, –∞ {player_name} –¥–æ–≤–æ–ª–µ–Ω."])
                input()
            case 3:
                score+=10
                draw_box(["+10 –æ—á–∫–æ–≤.",
                          "---",
                          f"{player_name} –∏–¥–µ—Ç –Ω–∞ –∫—É—Ö–Ω—é –∏ –≤—ã–¥–∞–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ ¬´–ú–Ø–£!¬ª. –°–æ–Ω–Ω—ã–π —Ö–æ–∑—è–∏–Ω, —á—Ç–æ–±—ã –∑–∞—Ç–∫–Ω—É—Ç—å —ç—Ç–æ—Ç —Å–∏—Ä–µ–Ω—É, –Ω–∞—Å—ã–ø–∞–µ—Ç –ø–æ–ª–Ω—É—é –º–∏—Å–∫—É –∫–æ—Ä–º–∞."])
                input()
            case _:
                os.system('cls' if os.name == 'nt' else 'clear')
                print("–í—ã–±–æ—Ä —É —Ç–µ–±—è –Ω–µ –æ—Å–æ–±–æ –≤–µ–ª–∏–∫...")
    except ValueError:
        os.system('cls' if os.name == 'nt' else 'clear')
        print("–í —á–µ–º –¥–µ–ª–æ? –ù–∞–¥–æ —Ü–∏—Ñ—Ä—É –≤–≤–µ—Å—Ç–∏, –∞ –Ω–µ –±—É–∫–≤—É")
    os.system('cls' if os.name == 'nt' else 'clear')
    #–ì–ª–∞–≤–∞ 2
    try:
        draw_hud(lives, score)
        draw_box([f"–ö–≤–∞—Ä—Ç–∏—Ä–∞ –ø—É—Å—Ç–∞. –ö–æ–∂–∞–Ω—ã–µ –º–µ—à–∫–∏ —É—à–ª–∏ –¥–æ–±—ã–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã, –æ—Å—Ç–∞–≤–∏–≤ {player_name} –ø–æ–ª–Ω–æ–ø—Ä–∞–≤–Ω—ã–º –≤–ª–∞—Å—Ç–µ–ª–∏–Ω–æ–º —ç—Ç–∏—Ö –∑–µ–º–µ–ª—å. \n–ù–∞ –ø–æ–¥–æ–∫–æ–Ω–Ω–∏–∫–µ –∫—Ä–∞—Å—É–µ—Ç—Å—è –∫–∞–∫—Ç—É—Å. –¢–∏—à–∏–Ω—É –Ω–∞—Ä—É—à–∞–µ—Ç –ª–∏—à—å –Ω–∞–≥–ª–æ–µ –∂—É–∂–∂–∞–Ω–∏–µ. –ù–∞ –æ–∫–æ–Ω–Ω–æ–º —Å—Ç–µ–∫–ª–µ —Å–∏–¥–∏—Ç –û–ù–ê. \n–ñ–∏—Ä–Ω–∞—è, —á–µ—Ä–Ω–∞—è –º—É—Ö–∞. –û–Ω–∞ –ø–æ—Ç–∏—Ä–∞–µ—Ç –ª–∞–ø–∫–∏, —Å–ª–æ–≤–Ω–æ –Ω–∞—Å–º–µ—Ö–∞—è—Å—å –Ω–∞–¥ —Ö–∏—â–Ω–∏–∫–æ–º. \n{player_name} —á—É–≤—Å—Ç–≤—É–µ—Ç, –∫–∞–∫ –¥–µ—Ä–≥–∞–µ—Ç—Å—è –µ–≥–æ —Ö–≤–æ—Å—Ç. –ò–Ω—Å—Ç–∏–Ω–∫—Ç —É–±–∏–π—Ü—ã –ø—Ä–æ—Å–Ω—É–ª—Å—è.",
                    "---",
                    "1. –£—Å—Ç—Ä–æ–∏—Ç—å –∑–∞—Å–∞–¥—É –Ω–∞ –ø–æ–¥–æ–∫–æ–Ω–Ω–∏–∫–µ.",
                    "2. –ü—Ä–æ—Å—Ç–æ –ø–æ—Å–ø–∞—Ç—å –≤ –ª—É—á–µ —Å–æ–ª–Ω—Ü–∞.",
                    "3. –°—ä–µ—Å—Ç—å –∫–∞–∫—Ç—É—Å."
                    ])
        ans=int(input("–í–∞—à –≤—ã–±–æ—Ä: "))
        os.system('cls' if os.name == 'nt' else 'clear')
        match ans:
            case 1:
                score+=20
                draw_box(["+20 –æ—á–∫–æ–≤.",
                          "---",
                          f"–†–µ–∑–∫–∏–π –ø—Ä—ã–∂–æ–∫! –•–í–ê–¢–¨! –ú—É—Ö–∞ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –∑—É–±–∞—Ö. {player_name} —Ö—Ä—É—Å—Ç–∏—Ç –¥–æ–±—ã—á–µ–π."])
                input()
            case 2:
                score+=10
                draw_box(["+10 –æ—á–∫–æ–≤.",
                          "---",
                          f"{player_name} –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –º—É—Ö—É –∏ —Ä–∞—Å—Ç–µ–∫–∞–µ—Ç—Å—è –ª—É–∂–∏—Ü–µ–π –Ω–∞ —Å–æ–ª–Ω–µ—á–Ω–æ–º –ø—è—Ç–Ω–µ. –≠–Ω–µ—Ä–≥–∏—è –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è."])
                input()
            case 3:
                lives-=1
                draw_box(["-1 –∂–∏–∑–Ω—å.",
                          "---",
                          f"{player_name} –∫—É—Å–∞–µ—Ç ¬´–∑–µ–ª–µ–Ω—É—é –º—É—Ö—É¬ª. –û—à–∏–±–∫–∞! –†–æ—Ç –ø–æ–ª–æ–Ω –∏–≥–æ–ª–æ–∫. –û–Ω –±–µ–≥–∞–µ—Ç –∏ –ø–ª—é–µ—Ç—Å—è."])
                input()
            case _:
                os.system('cls' if os.name == 'nt' else 'clear')
                print("–í—ã–±–æ—Ä —É —Ç–µ–±—è –Ω–µ –æ—Å–æ–±–æ –≤–µ–ª–∏–∫...")
    except ValueError:
        os.system('cls' if os.name == 'nt' else 'clear')
        print("–í —á–µ–º –¥–µ–ª–æ? –ù–∞–¥–æ —Ü–∏—Ñ—Ä—É –≤–≤–µ—Å—Ç–∏, –∞ –Ω–µ –±—É–∫–≤—É")
    os.system('cls' if os.name == 'nt' else 'clear')
    #–ì–ª–∞–≤–∞ 3
    try:
        draw_hud(lives, score)
        print(r"""
                   .---.
                 _/_____\_
                (_________)  <-- –†–û–ë–û–¢-–£–ë–ò–ô–¶–ê
                 |_______|
               __|_______|__
              /             \
             |               |
             |  –í–ñ–ñ–ñ–£–£–£–•!!!  |
             |_______________|
        """)
        draw_box([f"–í–Ω–µ–∑–∞–ø–Ω—É—é —Ç–∏—à–∏–Ω—É —Ä–∞–∑—Ä—ã–≤–∞–µ—Ç –∞–¥—Å–∫–∏–π —Ä–µ–≤. –ò–∑ —É–≥–ª–∞ –≤—ã–µ–∑–∂–∞–µ—Ç –û–ù ‚Äî –†–æ–±–æ—Ç-–ø—ã–ª–µ—Å–æ—Å. \n–ö—Ä—É–≥–ª—ã–π –¥–∏—Å–∫ –¥—å—è–≤–æ–ª–∞, –ø–æ–∂–∏—Ä–∞—Ç–µ–ª—å –Ω–æ—Å–∫–æ–≤ –∏ –≤—Ä–∞–≥ –≤—Å–µ–≥–æ –∂–∏–≤–æ–≥–æ. {player_name} —à–∏–ø–∏—Ç, \n–≤—ã–≥–∏–±–∞—è —Å–ø–∏–Ω—É –¥—É–≥–æ–π. –ß—É–¥–æ–≤–∏—â–µ –º–µ–¥–ª–µ–Ω–Ω–æ, –Ω–æ –≤–µ—Ä–Ω–æ –ø–æ–ª–∑–µ—Ç –≤ —Å—Ç–æ—Ä–æ–Ω—É –ª—é–±–∏–º–æ–π \n–ª–µ–∂–∞–Ω–∫–∏ –∫–æ—Ç–∞. –≠—Ç–æ –≤–æ–π–Ω–∞.",
                    "---",
                    "1. –ê—Ç–∞–∫–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É –≤—ã–∫–ª—é—á–µ–Ω–∏—è.",
                    "2. –ó–∞–Ω—è—Ç—å –≤—ã—Å–æ—Ç—É –Ω–∞ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–µ.",
                    "3. –ü–æ–Ω—é—Ö–∞—Ç—å –≤—Ä–∞—â–∞—é—â—É—é—Å—è —â–µ—Ç–∫—É."
                    ])
        ans=int(input("–í–∞—à –≤—ã–±–æ—Ä: "))
        os.system('cls' if os.name == 'nt' else 'clear')
        match ans:
            case 1:
                score+=10
                draw_box(["+10 –æ—á–∫–æ–≤.",
                          "---",
                          f"{player_name} –∑–∞–Ω–∏–º–∞–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫—É—é –≤—ã—Å–æ—Ç—É. –†–æ–±–æ—Ç –ø–æ–ª–∑–∞–µ—Ç –≤–Ω–∏–∑—É, –±–µ—Å—Å–∏–ª—å–Ω—ã–π –¥–æ—Å—Ç–∞—Ç—å —Ü–∞—Ä—è –≥–æ—Ä—ã."])
                input()
            case 2:
                score+=20
                draw_box(["+20 –æ—á–∫–æ–≤.",
                          "---",
                          f"–°–µ—Ä–∏—è —É–¥–∞—Ä–æ–≤ –ª–∞–ø–æ–π! –ë–ò–ü! –û–≥–Ω–∏ –≥–∞—Å–Ω—É—Ç, –º–æ–Ω—Å—Ç—Ä –∑–∞—Ç–∏—Ö. {player_name} –ø–æ–±–µ–¥–∏–ª –≤–æ—Å—Å—Ç–∞–Ω–∏–µ –º–∞—à–∏–Ω."])
                input()
            case 3:
                lives-=1
                draw_box(["-1 –∂–∏–∑–Ω—å.",
                          "---",
                          f"{player_name} —Å—É–µ—Ç –Ω–æ—Å –ø–æ–¥ –±–∞–º–ø–µ—Ä. –í–ñ–£–•! –£—Å—ã –Ω–∞–º–æ—Ç–∞–ª–æ –Ω–∞ –≤–∞–ª–∏–∫! –ü—Ä–∏—à–ª–æ—Å—å –≤—ã—Ä—ã–≤–∞—Ç—å—Å—è —Å–∏–ª–æ–π, –æ—Å—Ç–∞–≤–∏–≤ –∫–ª–æ–∫ —à–µ—Ä—Å—Ç–∏."])
                input()
            case _:
                os.system('cls' if os.name == 'nt' else 'clear')
                print("–í—ã–±–æ—Ä —É —Ç–µ–±—è –Ω–µ –æ—Å–æ–±–æ –≤–µ–ª–∏–∫...")
    except ValueError:
        os.system('cls' if os.name == 'nt' else 'clear')
        print("–í —á–µ–º –¥–µ–ª–æ? –ù–∞–¥–æ —Ü–∏—Ñ—Ä—É –≤–≤–µ—Å—Ç–∏, –∞ –Ω–µ –±—É–∫–≤—É")
    os.system('cls' if os.name == 'nt' else 'clear')
    if lives<=0:
        end_time=time.time()
        total_time=end_time-start_time
        print(f"–¢—ã —É–º–µ—Ä... \n–¢–≤–æ–∏ –æ—á–∫–∏:{score}\n–í—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è:{round(total_time)}\n")
        save_result(player_name, score, total_time)
        input("–ù–∞–∂–º–∏ –ª—é–±—É—é –∫–ª–∞–≤–∏—à—É —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é...")
        os.system('cls' if os.name == 'nt' else 'clear')
        return
    #–ì–ª–∞–≤–∞ 4
    try:
        draw_hud(lives, score)
        draw_box([f"–•–æ–∑—è–µ–≤–∞ –≤–µ—Ä–Ω—É–ª–∏—Å—å. –ù–∞ –∫—É—Ö–Ω–µ –ø–∞—Ö–Ω–µ—Ç –∂–∞—Ä–µ–Ω–æ–π –∫—É—Ä–∏—Ü–µ–π —Ç–∞–∫ —Å–∏–ª—å–Ω–æ, —á—Ç–æ —É {player_name} \n–∫—Ä—É–∂–∏—Ç—Å—è –≥–æ–ª–æ–≤–∞. –•–æ–∑—è–∏–Ω –æ—Ç–≤–µ—Ä–Ω—É–ª—Å—è, –Ω–∞—Ä–µ–∑–∞—è —Å–∞–ª–∞—Ç. –ù–∞ –∫—Ä–∞—é —Å—Ç–æ–ª–∞ —Å—Ç–æ–∏—Ç —Ç–∞—Ä–µ–ª–∫–∞ —Å \n–æ—Å—Ç—ã–≤–∞—é—â–∏–º–∏ –∫—É—Å–æ—á–∫–∞–º–∏ —Ñ–∏–ª–µ. –≠—Ç–æ—Ç –∑–∞–ø–∞—Ö —Å–≤–æ–¥–∏—Ç —Å —É–º–∞.",
                    "---",
                    "1. –ü—Ä—ã–≥–Ω—É—Ç—å –Ω–∞ –ø–ª–∏—Ç—É.",
                    "2. –°–¥–µ–ª–∞—Ç—å –º–∏–ª—ã–µ –≥–ª–∞–∑–∫–∏.",
                    "3. –£–∫—Ä–∞—Å—Ç—å –∫—É—Ä–∏—Ü—É."
                    ])
        ans=int(input("–í–∞—à –≤—ã–±–æ—Ä: "))
        os.system('cls' if os.name == 'nt' else 'clear')
        match ans:
            case 1:
                lives-=1
                draw_box(["-1 –∂–∏–∑–Ω—å.",
                          "---",
                          f"{player_name} –ø—Ä–æ–º–∞—Ö–∏–≤–∞–µ—Ç—Å—è –º–∏–º–æ —Å—Ç–æ–ª–∞ –∏ –ø—Ä–∏–∑–µ–º–ª—è–µ—Ç—Å—è –Ω–∞ –≥–æ—Ä—è—á—É—é –∫–æ–Ω—Ñ–æ—Ä–∫—É. –ü–®–®–®! –ó–∞–ø–∞—Ö –ø–∞–ª–µ–Ω–æ–π —à–µ—Ä—Å—Ç–∏ –∏ –¥–∏–∫–∏–π –≤–∏–∑–≥."])
                input()
            case 2:
                score+=10
                draw_box(["+10 –æ—á–∫–æ–≤.",
                          "---",
                          f"{player_name} —Ç—Ä–µ—Ç—Å—è –æ–± –Ω–æ–≥–∏ –∏ –º—É—Ä—á–∏—Ç. –•–æ–∑—è–∏–Ω —Ç–∞–µ—Ç: ¬´–ù—É –Ω–∞, –Ω–µ –ø–ª–∞—á—å¬ª. –õ–µ–≥–∞–ª—å–Ω—ã–π –∫—É—Å–æ—á–µ–∫ –ø–æ–ª—É—á–µ–Ω."])
                input()
            case 3:
                score+=20
                draw_box(["+20 –æ—á–∫–æ–≤.",
                          "---",
                          f"–õ–æ–≤–∫–æ—Å—Ç—å –ª–∞–ø –∏ –Ω–∏–∫–∞–∫–æ–≥–æ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞. –ü–æ–∫–∞ —Ö–æ–∑—è–∏–Ω –æ—Ç–≤–µ—Ä–Ω—É–ª—Å—è, –∫—É—Å–æ–∫ —Ñ–∏–ª–µ –∏—Å—á–µ–∑ –ø–æ–¥ –¥–∏–≤–∞–Ω. –í–∫—É—Å–Ω–æ!"])
                input()
            case _:
                os.system('cls' if os.name == 'nt' else 'clear')
                print("–í—ã–±–æ—Ä —É —Ç–µ–±—è –Ω–µ –æ—Å–æ–±–æ –≤–µ–ª–∏–∫...")
    except ValueError:
        os.system('cls' if os.name == 'nt' else 'clear')
        print("–í —á–µ–º –¥–µ–ª–æ? –ù–∞–¥–æ —Ü–∏—Ñ—Ä—É –≤–≤–µ—Å—Ç–∏, –∞ –Ω–µ –±—É–∫–≤—É")
    os.system('cls' if os.name == 'nt' else 'clear')
    if lives<=0:
        end_time = time.time()
        total_time = end_time - start_time
        print(f"–¢—ã —É–º–µ—Ä... \n–¢–≤–æ–∏ –æ—á–∫–∏:{score}\n–í—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è:{round(total_time)}\n")
        save_result(player_name, score, total_time)
        input("–ù–∞–∂–º–∏ –ª—é–±—É—é –∫–ª–∞–≤–∏—à—É —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é...")
        os.system('cls' if os.name == 'nt' else 'clear')
        return
    #–ì–ª–∞–≤–∞ 5
    try:
        draw_hud(lives, score)
        draw_box([f"–ì–ª—É–±–æ–∫–∞—è –Ω–æ—á—å. –õ—É–Ω–∞ —Å–≤–µ—Ç–∏—Ç –≤ –æ–∫–Ω–æ. –í—Å–µ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤ —Å–ø—è—Ç, –Ω–æ —É {player_name} \n—Ä–∞—Å—à–∏—Ä—è—é—Ç—Å—è –∑—Ä–∞—á–∫–∏. –î—Ä–µ–≤–Ω–∏–µ –¥–µ–º–æ–Ω—ã —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤—Å–µ–ª—è—é—Ç—Å—è –≤ –µ–≥–æ –ø—É—à–∏—Å—Ç–æ–µ —Ç–µ–ª–æ. \n–≠–Ω–µ—Ä–≥–∏—è –ø–µ—Ä–µ–ø–æ–ª–Ω—è–µ—Ç –ª–∞–ø—ã. –ï–º—É –Ω—É–∂–Ω–æ –±–µ–∂–∞—Ç—å. –ë—ã—Å—Ç—Ä–æ. –í–µ–∑–¥–µ. –°–ï–ô–ß–ê–°.",
                    "---",
                    "1. –£—Ä–æ–Ω–∏—Ç—å –≤–∞–∑—É.",
                    "2. –í–ª–µ—Ç–µ—Ç—å –≤ –¥–≤–µ—Ä—å.",
                    "3. –ü–∞—Ä–∫—É—Ä –ø–æ —Å—Ç–µ–Ω–∞–º."
                    ])
        ans=int(input("–í–∞—à –≤—ã–±–æ—Ä: "))
        os.system('cls' if os.name == 'nt' else 'clear')
        match ans:
            case 1:
                score+=20
                draw_box(["+20 –æ—á–∫–æ–≤.",
                          "---",
                          f"–õ–∞–ø–∞ —Ç–æ–ª–∫–∞–µ—Ç —Ñ–∞—Ä—Ñ–æ—Ä. –ë–î–´–©!!! –û—Å–∫–æ–ª–∫–∏ –≤–µ–∑–¥–µ. –•–æ–∑—è–∏–Ω –æ—Ä–µ—Ç, –Ω–æ {player_name} –¥–æ–≤–æ–ª–µ–Ω —Ö–∞–æ—Å–æ–º."])
                input()
            case 2:
                lives-=1
                draw_box(["-1 –∂–∏–∑–Ω—å.",
                          "---",
                          "–†–∞–∑–≥–æ–Ω –¥–æ 100 –∫–º/—á... –∏ —É–¥–∞—Ä –≥–æ–ª–æ–≤–æ–π –æ –∑–∞–∫—Ä—ã—Ç—É—é —Å—Ç–µ–∫–ª—è–Ω–Ω—É—é –¥–≤–µ—Ä—å. –ë–û–ù–¨–ö! –ü—Ç–∏—á–∫–∏ –≤ –≥–ª–∞–∑–∞—Ö."])
                input()
            case 3:
                score+=10
                draw_box(["+10 –æ—á–∫–æ–≤.",
                          "---",
                          f"{player_name} –±–µ–≥–∞–µ—Ç –ø–æ —Å—Ç–µ–Ω–∞–º –∫–æ—Ä–∏–¥–æ—Ä–∞, –Ω–µ –∫–∞—Å–∞—è—Å—å –ø–æ–ª–∞. –ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è –¥–ª—è —Å–ª–∞–±–∞–∫–æ–≤."])
                input()
            case _:
                os.system('cls' if os.name == 'nt' else 'clear')
                print("–í—ã–±–æ—Ä —É —Ç–µ–±—è –Ω–µ –æ—Å–æ–±–æ –≤–µ–ª–∏–∫...")
    except ValueError:
        os.system('cls' if os.name == 'nt' else 'clear')
        print("–í —á–µ–º –¥–µ–ª–æ? –ù–∞–¥–æ —Ü–∏—Ñ—Ä—É –≤–≤–µ—Å—Ç–∏, –∞ –Ω–µ –±—É–∫–≤—É")
    os.system('cls' if os.name == 'nt' else 'clear')
    if lives<=0:
        end_time = time.time()
        total_time = end_time - start_time
        print(f"–¢—ã —É–º–µ—Ä... \n–¢–≤–æ–∏ –æ—á–∫–∏:{score}\n–í—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è:{round(total_time)}\n")
        save_result(player_name, score, total_time)
        input("–ù–∞–∂–º–∏ –ª—é–±—É—é –∫–ª–∞–≤–∏—à—É —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é...")
        os.system('cls' if os.name == 'nt' else 'clear')
        return
    elif score<=100:
        end_time = time.time()
        total_time = end_time - start_time
        print(r"""
            ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
            ‚ïë –¢–´ –ü–û–ë–ï–î–ò–õ!    ‚ïë
            ‚ïë –ö–û–†–û–õ–¨ –ö–í–ê–†–¢–ò–†–´‚ïë
            ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
                |\__/| ||
                (‚Ä¢„ÖÖ-) ||
                / „ÄÄ „Å•        
        """)
        print(f"–¢–≤–æ–∏ –æ—á–∫–∏: {score} \n–¢–≤–æ–µ –≤—Ä–µ–º—è:{round(total_time)}")
        if score==100:
            print(f"–û–≥–æ! –∫–æ—Ç–∏–∫ {player_name} –Ω–∞–±—Ä–∞–ª –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª-–≤–æ –æ—á–∫–æ–≤!\n–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!")
        save_result(player_name, score, total_time)
        input("–ù–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–ª–∞–≤–∏—à—É –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é...")
        os.system('cls' if os.name == 'nt' else 'clear')
    return

def list_score():
    os.system('cls' if os.name == 'nt' else 'clear')
    filename=get_save_path()
    if not filename.exists():
        with filename.open("w", encoding="utf-8") as f:
            json.dump([],f)
    try:
        with filename.open("r", encoding="utf-8") as f:
            all_records = json.load(f)
    except (json.decoder.JSONDecodeError, ValueError):
        all_records = []
        print("[!] –û—à–∏–±–∫–∞: —Ñ–∞–π–ª —Ä–µ–∫–æ—Ä–¥–æ–≤ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω. –ù–∞—á–∏–Ω–∞–µ–º —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞.")
    if not all_records:
        print("‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó")
        print("‚ïë    –¢–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è :(     ‚ïë")
        print("‚ïë –ü–æ–ø—Ä–æ–±—É–π —Å—ã–≥—Ä–∞—Ç—å –≤ –∏–≥—Ä—É! ‚ïë")
        print("‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù")
        input("–ù–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–ª–∞–≤–∏—à—É –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...")
        os.system('cls' if os.name == 'nt' else 'clear')
        return
    all_records.sort(key=lambda x: (x["score"], -x['total_time']), reverse=True)
    print("‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¶‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¶‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¶‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó")
    print("‚ïë  ‚Ññ  ‚ïë       –ò–º—è –∫–æ—Ç–∏–∫–∞      ‚ïë –û—á–∫–∏ ‚ïë  –í—Ä–µ–º—è  ‚ïë")
    print("‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¨‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¨‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï¨‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£")
    for index, item in enumerate(all_records, start=1):
        column_w=21
        name=item['player_name']
        time=f"{round(item['total_time'])} c."
        if item['score']==100:
            name=f"üëë {name}"
            column_w-=1
        score=str(item['score'])
        print(f"‚ïë {str(index).ljust(3)} ‚ïë {name.ljust(column_w)} ‚ïë {score.ljust(4)} ‚ïë {time.ljust(7)} ‚ïë")
    print("‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ï©‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï©‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï©‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù")
    input("–ù–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–ª–∞–≤–∏—à—É –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...")
    os.system('cls' if os.name == 'nt' else 'clear')
    return

def exit_game():
    os.system('cls' if os.name == 'nt' else 'clear')
    while True:
        ans_1=input("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏ –∏–∑ –∏–≥—Ä—ã?(Y/N): ")
        os.system('cls' if os.name == 'nt' else 'clear')
        match ans_1:
            case "Y" | "y":
                print("–î–æ –≤—Å—Ç—Ä–µ—á–∏!")
                sys.exit()
            case "N" | "n":
                return
            case _:
                print("–¢–µ–±–µ –∂–µ —Å–∫–∞–∑–∞–ª–∏ y/n. –ê —Ç—ã —á—Ç–æ —Ö—É–π–Ω—é –ø–∏—à–µ—à—å?")

def main():
    os.system('cls' if os.name == 'nt' else 'clear')
    while True:
        try:
            draw_box([
            "–ö–æ—à–∞—á–∏–π –ø–µ—Ä–µ–ø–æ–ª–æ—Ö‚ô•",
            "---",
            "1. –ò–≥—Ä–∞—Ç—å!",
            "2. –¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∫–æ—Ä–¥–æ–≤.",
            "3. –ö–æ—Ç–∏–∫?!",
            "4. –í—ã—Ö–æ–¥ :("
            ])
            ans=int(input("–í—ã–±–µ—Ä–∏—Ç–µ —Ü–∏—Ñ—Ä—É –º–µ–Ω—é: "))
            os.system('cls' if os.name == 'nt' else 'clear')
            match ans:
                case 1:
                    start_game()
                case 2:
                    list_score()
                case 3:
                    cat_anim()
                case 4:
                    exit_game()
                case _:
                    print("–ê —Ç—ã —á—Ç–æ, –≤–∏–¥–∏—à—å —Ç—É—Ç –±–æ–ª—å—à–µ 4??")
        except ValueError:
            os.system('cls' if os.name == 'nt' else 'clear')
            print("–¢—ã –µ–±–∞–Ω–∞—Ç?) –ü–æ–ø—Ä–æ—Å–∏–ª–∏ –∂–µ –±–ª—è—Ç—å —Ü–∏—Ñ—Ä—É...")

if __name__ == "__main__":
    main()